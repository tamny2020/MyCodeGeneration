[
  {
    "Id": "534742",
    "ThreadId": "238110",
    "Html": "\r\n<p>Hi there,</p>\r\n<p>I love Razor in MVC and thought I would try to generate an OpenXml document with it (we need a document templating engine). It works beautifully if I don't have a loop :) I am having a problem with loops though.</p>\r\n<p>&nbsp;If I type into this word</p>\r\n<p style=\"padding-left:30px\">&nbsp;</p>\r\n<pre>Name : @Model.Name made by Razor.\r\n\r\n@foreach(var disb in Model.Children){\r\n\r\n@disb.Name\r\n\r\n}\r\n</pre>\r\n<pre><br></pre>\r\n<pre>and run it, I get an exception &quot;Encountered end tag 'w:t' with no matching start tag. &nbsp;Are your start/end tags properly balanced?&quot;. I am guessing that this is because the xml from word is not the way I would do MVC HTML, but the tags would balance if the loop ran.</pre>\r\n<pre>The openxml (elided for clarity) looks like this :</pre>\r\n<pre><div style=\"color:black; background-color:white\"><pre><span style=\"color:blue\">&lt;?</span><span style=\"color:#a31515\">xml</span> <span style=\"color:red\">version</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">1.0</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">encoding</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">UTF-8</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">standalone</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">yes</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">?&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">document</span> <span style=\"color:red\">xmlns:wpc</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:mc</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.openxmlformats.org/markup-compatibility/2006</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:o</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">urn:schemas-microsoft-com:office:office</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:r</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.openxmlformats.org/officeDocument/2006/relationships</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:m</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.openxmlformats.org/officeDocument/2006/math</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:v</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">urn:schemas-microsoft-com:vml</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:wp14</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:wp</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:w10</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">urn:schemas-microsoft-com:office:word</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:w</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.openxmlformats.org/wordprocessingml/2006/main</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:w14</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/word/2010/wordml</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:wpg</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/word/2010/wordprocessingGroup</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:wpi</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/word/2010/wordprocessingInk</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:wne</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/word/2006/wordml</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:wps</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/word/2010/wordprocessingShape</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">mc:Ignorable</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">w14 wp14</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">body</span><span style=\"color:blue\">&gt;</span>\r\n\t\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">p</span> <span style=\"color:red\">w:rsidR</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">00194E6E</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">w:rsidRPr</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">005939D1</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">w:rsidRDefault</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">00E64FEC</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">w:rsidP</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">005939D1</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span> <span style=\"color:red\">w:rsidRPr</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">005939D1</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>@foreach(var disb in Model.Children){<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span> <span style=\"color:red\">w:rsidRPr</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">005939D1</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>@disb.Name<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span> <span style=\"color:red\">w:rsidRPr</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">005939D1</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>}<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n\t\t<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">p</span><span style=\"color:blue\">&gt;</span>\r\n\t<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">body</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">document</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<br></pre>\r\n<pre>I know this is an off the wall request, but can I specify a different parser perhaps (the default HTML one might well be inappropriate, of course)? Should I make my own ? The tags should all balance out after the loop has run.</pre>\r\n<pre><br></pre>\r\n<pre>Thanks </pre>\r\n<pre><br></pre>\r\n<pre>The full exception is :</pre>\r\n<pre><pre><pre>RazorEngine.Templating.TemplateParsingException was unhandled\r\n  Message=Encountered end tag 'w:t' with no matching start tag.  Are your start/end tags properly balanced?\r\n  Source=RazorEngine.Core\r\n  Column=1513\r\n  Line=1\r\n  StackTrace:\r\n       at RazorEngine.Compilation.CSharpRazorCodeGenerator.VisitError(RazorError err) in C:\\TFS\\play\\Razor\\RazorEngine.Core\\Compilation\\CSharpRazorCodeGenerator.cs:line 32\r\n       at System.Web.Razor.Parser.ParserContext.OnError(SourceLocation location, String message)\r\n       at System.Web.Razor.Parser.ParserContext.OnError(SourceLocation location, String message, Object[] args)\r\n       at System.Web.Razor.Parser.ParserBase.OnError(SourceLocation location, String message, Object[] args)\r\n       at System.Web.Razor.Parser.HtmlMarkupParser.ParseEndTag(Stack`1 tags, TagInfo tag, Boolean acceptUnmatchedEndTag)\r\n       at System.Web.Razor.Parser.HtmlMarkupParser.ParseTagBlock(Boolean inDocument)\r\n       at System.Web.Razor.Parser.HtmlMarkupParser.ParseBlock()\r\n       at System.Web.Razor.Parser.ParserBase.ParseBlockWithOtherParser(SpanFactory previousSpanFactory, Boolean collectTransitionToken)\r\n       at System.Web.Razor.Parser.CSharpCodeParser.ParseStatement(CodeBlockInfo block)\r\n       at System.Web.Razor.Parser.CSharpCodeParser.ParseCodeBlock(CodeBlockInfo block, Boolean bracesAreMetacode)\r\n       at System.Web.Razor.Parser.CSharpCodeParser.ParseControlFlowBody(CodeBlockInfo block)\r\n       at System.Web.Razor.Parser.CSharpCodeParser.ParseConditionalBlockStatement(CodeBlockInfo block)\r\n       at System.Web.Razor.Parser.CSharpCodeParser.&lt;&gt;c__DisplayClass3.b__2(CodeBlockInfo block)\r\n       at System.Web.Razor.Parser.CSharpCodeParser.ParseBlock()\r\n       at System.Web.Razor.Parser.ParserBase.ParseBlockWithOtherParser(SpanFactory previousSpanFactory, Boolean collectTransitionToken)\r\n       at System.Web.Razor.Parser.HtmlMarkupParser.TryStartCodeParser(Boolean isSingleLineMarkup, Boolean documentLevel)\r\n       at System.Web.Razor.Parser.HtmlMarkupParser.ParseRootBlock(Tuple`2 nestingSequences, Boolean caseSensitive)\r\n       at System.Web.Razor.Parser.HtmlMarkupParser.ParseDocument()\r\n       at System.Web.Razor.Parser.RazorParser.Parse(LookaheadTextReader input, ParserVisitor visitor)\r\n       at System.Web.Razor.Parser.RazorParser.Parse(TextReader input, ParserVisitor visitor)\r\n       at RazorEngine.Compilation.RazorCompiler.ParseTemplate(String template, RazorParser parser, ParserVisitor visitor) in C:\\TFS\\play\\Razor\\RazorEngine.Core\\Compilation\\RazorCompiler.cs:line 276\r\n       at RazorEngine.Compilation.RazorCompiler.CompileTemplate(String className, String template, Type modelType) in C:\\TFS\\play\\Razor\\RazorEngine.Core\\Compilation\\RazorCompiler.cs:line 150\r\n       at RazorEngine.Compilation.RazorCompiler.CreateTemplate(String template, Type modelType) in C:\\TFS\\play\\Razor\\RazorEngine.Core\\Compilation\\RazorCompiler.cs:line 176\r\n       at RazorEngine.Templating.TemplateService.GetTemplate(String template, Type modelType, String name) in C:\\TFS\\play\\Razor\\RazorEngine.Core\\Templating\\TemplateService.cs:line 51\r\n       at RazorEngine.Templating.TemplateService.Parse[T](String template, T model, String name) in C:\\TFS\\play\\Razor\\RazorEngine.Core\\Templating\\TemplateService.cs:line 85\r\n       at RazorEngine.Razor.Parse[T](String template, T model, String name) in C:\\TFS\\play\\Razor\\RazorEngine.Core\\Razor.cs:line 61\r\n       at RazorApp.Program.Main(String[] args) in c:\\TFS\\play\\RazorApp\\RazorApp\\Program.cs:line 23\r\n       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)\r\n       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)\r\n       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()\r\n       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)\r\n       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)\r\n       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\r\n       at System.Threading.ThreadHelper.ThreadStart()\r\n  InnerException: \r\n</pre>\r\n<br></pre>\r\n</pre>\r\n",
    "PostedDate": "2010-12-12T13:32:52.917-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "535168",
    "ThreadId": "238110",
    "Html": "\r\n<p>Hi,</p>\r\n<p>The Microsoft implementation of the CSharpRazorCodeGenerator actually swallows any errors that occur through parsing. &nbsp;What might work for you is if you create a new ILanguageProvider, and have it return that default implementation instead of our subclassed\r\n version, e.g.:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">using</span> System.CodeDom.Compiler;\r\n<span style=\"color:blue\">using</span> System.Web.Razor;\r\n\r\n<span style=\"color:blue\">using</span> Microsoft.CSharp;\r\n\r\n<span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span> MyCSharpLanguageProvider : ILanguageProvider\r\n{\r\n  <span style=\"color:blue\">#region</span> Methods\r\n  <span style=\"color:blue\">public</span> RazorCodeLanguage CreateLanguageService()\r\n  {\r\n    <span style=\"color:blue\">return</span> <span style=\"color:blue\">new</span> System.Web.Razor.CSharpRazorCodeLanguage();\r\n  }\r\n  \r\n  <span style=\"color:blue\">public</span> CodeDomProvider CreateCodeDomProvider()\r\n  {\r\n    <span style=\"color:blue\">return</span> <span style=\"color:blue\">new</span> CSharpCodeProvider();\r\n  }\r\n  <span style=\"color:blue\">#endregion</span>\r\n}\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>You can then assign the language provider through either the Razor static class, or the TemplateService (if you are using one directly):</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>Razor.SetLanguageProvider(<span style=\"color:blue\">new</span> MyCSharpLanguageProvider());\r\n</pre>\r\n</div>\r\nUntil we potentially add support for Strict vs. Fault Friendly parsing mode, this may have to do.\r\n<p></p>\r\n",
    "PostedDate": "2010-12-13T12:29:59.173-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "535246",
    "ThreadId": "238110",
    "Html": "\r\n<p>Thanks Antaris, that got me further. My next issue is that because the } is in the middle of an openXml tag, it appears that the Razor parser has decided that the brace is not code, so this part of the openXml doument</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span> <span style=\"color:red\">w:rsidRPr</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">005939D1</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>}<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>produces&nbsp;</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>                WriteLiteral(<span style=\"color:#a31515\">&quot;&lt;w:p w:rsidR=\\&quot;002504E8\\&quot; w:rsidRDefault=\\&quot;00FE3C1C\\&quot; w:rsidP=\\&quot;005939D1\\&quot;&gt;&lt;w:r&gt;&lt;w:t&gt;}&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;&quot;</span>);\r\n\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>in the generated code. Is there any inverse of escaping, i.e. is there a way I can specify that something IS code ? I see I can escape things to not be code (@@) etc, but it appears I need the reverse. I tried @} and a few variations, but with the same result.</p>\r\n<p>Many Thanks,</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-12-13T15:32:48.913-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "536236",
    "ThreadId": "238110",
    "Html": "\r\n<p>This is going to be a little trickier. &nbsp;The reality is you're actually approaching this from the opposite direction, whereby you are using Word to essentially generate your markup around your tags, instead of using Razor to generate your markup after\r\n it has processed its code.</p>\r\n<p>&nbsp;</p>\r\n<p>Would it be better to use Razor to generate the raw document.xml file, without using Word? I would expect it to work that way, as doing it the current way it is generating xml nodes for the placement of the Razor code, when those nodes are going to be redundant\r\n after you've parsed the file anyway?</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;?</span><span style=\"color:#a31515\">xml</span> <span style=\"color:red\">version</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">1.0</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">encoding</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">UTF-8</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">standalone</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">yes</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">?&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">document</span> <span style=\"color:red\">xmlns:wpc</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:mc</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.openxmlformats.org/markup-compatibility/2006</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:o</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">urn:schemas-microsoft-com:office:office</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:r</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.openxmlformats.org/officeDocument/2006/relationships</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:m</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.openxmlformats.org/officeDocument/2006/math</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:v</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">urn:schemas-microsoft-com:vml</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:wp14</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:wp</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:w10</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">urn:schemas-microsoft-com:office:word</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:w</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.openxmlformats.org/wordprocessingml/2006/main</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:w14</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/word/2010/wordml</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:wpg</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/word/2010/wordprocessingGroup</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:wpi</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/word/2010/wordprocessingInk</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:wne</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/word/2006/wordml</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">xmlns:wps</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/word/2010/wordprocessingShape</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">mc:Ignorable</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">w14 wp14</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">body</span><span style=\"color:blue\">&gt;</span>\r\n\t\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">p</span> <span style=\"color:red\">w:rsidR</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">00194E6E</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">w:rsidRPr</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">005939D1</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">w:rsidRDefault</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">00E64FEC</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">w:rsidP</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">005939D1</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t@foreach(var disb in Model.Children){\r\n\t\t\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span> <span style=\"color:red\">w:rsidRPr</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">005939D1</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>@disb.Name<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t}\r\n\t\t<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">p</span><span style=\"color:blue\">&gt;</span>\r\n\t<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">body</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">document</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>Notice how I don't have the additional &lt;w:r&gt; elements for the Razor code. &nbsp;I don't think you'd be able to use Word as the generator for building your templates as it takes the Razor code as literal text (hence it generating the additional elements).</p>\r\n",
    "PostedDate": "2010-12-15T09:26:18.24-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "536259",
    "ThreadId": "238110",
    "Html": "\r\n<p>Hi Antaris,</p>\r\n<p>Thanks for the response. You are correct, if one authors the openxml directly it works perfectly, and of course that's how Razor was designed to be used. I was hoping that users could edit their templates in word and only see the C#, and no xml.</p>\r\n<p>Next of course, I will be asking for support for Expression Web and FrontPage, lol.</p>\r\n<p>I will regrettably have to explore other templating engines for document generation, and keep my Razor love in MVC.</p>\r\n<p>Many thanks for all your Help.</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-12-15T10:29:42.633-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]